<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Map making | CASA0005 Geographic Information Systems and Science</title>
  <meta name="description" content="Chapter 5 Map making | CASA0005 Geographic Information Systems and Science" />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Map making | CASA0005 Geographic Information Systems and Science" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Map making | CASA0005 Geographic Information Systems and Science" />
  
  
  

<meta name="author" content="Andy MacLachlan and Adam Dennett" />


<meta name="date" content="2019-07-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="git-github-and-rmarkdown.html">
<link rel="next" href="an-introduction-to-analysing-spatial-patterns.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.46.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.46.1/plotly-latest.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.2/leaflet.js"></script>
<script src="libs/leaflet-providers-1.1.17/leaflet-providers.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.2/leaflet-providers-plugin.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">CASA0005</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-world-of-gis"><i class="fa fa-check"></i>The world of GIS</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#getting-started"><i class="fa fa-check"></i>Getting started</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#offline-viewing"><i class="fa fa-check"></i>Offline viewing</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#more-help"><i class="fa fa-check"></i>More help</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#noticed-a-mistake"><i class="fa fa-check"></i>Noticed a mistake?</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="geographic-information.html"><a href="geographic-information.html"><i class="fa fa-check"></i><b>1</b> Geographic Information</a><ul>
<li class="chapter" data-level="1.1" data-path="geographic-information.html"><a href="geographic-information.html#learning-outcomes"><i class="fa fa-check"></i><b>1.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="1.2" data-path="geographic-information.html"><a href="geographic-information.html#the-basics-of-geographic-information"><i class="fa fa-check"></i><b>1.2</b> The Basics of Geographic Information</a><ul>
<li class="chapter" data-level="1.2.1" data-path="geographic-information.html"><a href="geographic-information.html#important-gis-data-formats"><i class="fa fa-check"></i><b>1.2.1</b> Important GIS data formats</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="geographic-information.html"><a href="geographic-information.html#data"><i class="fa fa-check"></i><b>1.3</b> Data</a><ul>
<li class="chapter" data-level="1.3.1" data-path="geographic-information.html"><a href="geographic-information.html#file-paths"><i class="fa fa-check"></i><b>1.3.1</b> File paths</a></li>
<li class="chapter" data-level="1.3.2" data-path="geographic-information.html"><a href="geographic-information.html#data-download"><i class="fa fa-check"></i><b>1.3.2</b> Data download</a></li>
<li class="chapter" data-level="1.3.3" data-path="geographic-information.html"><a href="geographic-information.html#data-pre-processing"><i class="fa fa-check"></i><b>1.3.3</b> Data pre-processing</a></li>
<li class="chapter" data-level="1.3.4" data-path="geographic-information.html"><a href="geographic-information.html#data-loading"><i class="fa fa-check"></i><b>1.3.4</b> Data loading</a></li>
<li class="chapter" data-level="1.3.5" data-path="geographic-information.html"><a href="geographic-information.html#arcgis"><i class="fa fa-check"></i><b>1.3.5</b> ArcGIS</a></li>
<li class="chapter" data-level="1.3.6" data-path="geographic-information.html"><a href="geographic-information.html#qgis"><i class="fa fa-check"></i><b>1.3.6</b> QGIS</a></li>
<li class="chapter" data-level="1.3.7" data-path="geographic-information.html"><a href="geographic-information.html#r"><i class="fa fa-check"></i><b>1.3.7</b> R</a></li>
<li class="chapter" data-level="1.3.8" data-path="geographic-information.html"><a href="geographic-information.html#export-data-2"><i class="fa fa-check"></i><b>1.3.8</b> Export data</a></li>
<li class="chapter" data-level="1.3.9" data-path="geographic-information.html"><a href="geographic-information.html#what-will-i-use-1"><i class="fa fa-check"></i><b>1.3.9</b> What will I use</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="geographic-information.html"><a href="geographic-information.html#data-sources-and-task"><i class="fa fa-check"></i><b>1.4</b> Data sources and task</a><ul>
<li class="chapter" data-level="1.4.1" data-path="geographic-information.html"><a href="geographic-information.html#uk-data-service"><i class="fa fa-check"></i><b>1.4.1</b> UK Data Service</a></li>
<li class="chapter" data-level="1.4.2" data-path="geographic-information.html"><a href="geographic-information.html#ons"><i class="fa fa-check"></i><b>1.4.2</b> ONS</a></li>
<li class="chapter" data-level="1.4.3" data-path="geographic-information.html"><a href="geographic-information.html#os"><i class="fa fa-check"></i><b>1.4.3</b> OS</a></li>
<li class="chapter" data-level="1.4.4" data-path="geographic-information.html"><a href="geographic-information.html#edina-digimap"><i class="fa fa-check"></i><b>1.4.4</b> Edina Digimap</a></li>
<li class="chapter" data-level="1.4.5" data-path="geographic-information.html"><a href="geographic-information.html#osm"><i class="fa fa-check"></i><b>1.4.5</b> OSM</a></li>
<li class="chapter" data-level="1.4.6" data-path="geographic-information.html"><a href="geographic-information.html#defra"><i class="fa fa-check"></i><b>1.4.6</b> DEFRA</a></li>
<li class="chapter" data-level="1.4.7" data-path="geographic-information.html"><a href="geographic-information.html#data-lists"><i class="fa fa-check"></i><b>1.4.7</b> Data lists</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="geographic-information.html"><a href="geographic-information.html#summary"><i class="fa fa-check"></i><b>1.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#learning-outcomes-1"><i class="fa fa-check"></i><b>2.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#introduction-3"><i class="fa fa-check"></i><b>2.2</b> Introduction</a><ul>
<li class="chapter" data-level="2.2.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#online-forums-are-your-friend"><i class="fa fa-check"></i><b>2.2.1</b> Online forums are your friend!!</a></li>
<li class="chapter" data-level="2.2.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#r-and-rstudio"><i class="fa fa-check"></i><b>2.2.2</b> R and RStudio</a></li>
<li class="chapter" data-level="2.2.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#getting-started-1"><i class="fa fa-check"></i><b>2.2.3</b> Getting started</a></li>
<li class="chapter" data-level="2.2.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#basics-1"><i class="fa fa-check"></i><b>2.2.4</b> Basics</a></li>
<li class="chapter" data-level="2.2.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#scripts-and-some-basic-commands"><i class="fa fa-check"></i><b>2.2.5</b> Scripts and some basic commands</a></li>
<li class="chapter" data-level="2.2.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#functions"><i class="fa fa-check"></i><b>2.2.6</b> Functions</a></li>
<li class="chapter" data-level="2.2.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#basic-plotting"><i class="fa fa-check"></i><b>2.2.7</b> Basic plotting</a></li>
<li class="chapter" data-level="2.2.8" data-path="introduction-to-r.html"><a href="introduction-to-r.html#help"><i class="fa fa-check"></i><b>2.2.8</b> Help</a></li>
<li class="chapter" data-level="2.2.9" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-types"><i class="fa fa-check"></i><b>2.2.9</b> Data types</a></li>
<li class="chapter" data-level="2.2.10" data-path="introduction-to-r.html"><a href="introduction-to-r.html#elements-of-a-data-frame"><i class="fa fa-check"></i><b>2.2.10</b> Elements of a data frame</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#reading-data-into-r"><i class="fa fa-check"></i><b>2.3</b> Reading data into R</a><ul>
<li class="chapter" data-level="2.3.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#old-skool-cleaning"><i class="fa fa-check"></i><b>2.3.1</b> Old skool cleaning</a></li>
<li class="chapter" data-level="2.3.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#new-skool-cleaning"><i class="fa fa-check"></i><b>2.3.2</b> New skool cleaning</a></li>
<li class="chapter" data-level="2.3.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#examining-your-new-data"><i class="fa fa-check"></i><b>2.3.3</b> Examining your new data</a></li>
<li class="chapter" data-level="2.3.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-manipulation-in-r"><i class="fa fa-check"></i><b>2.3.4</b> Data manipulation in R</a></li>
<li class="chapter" data-level="2.3.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#plotting"><i class="fa fa-check"></i><b>2.3.5</b> Plotting</a></li>
<li class="chapter" data-level="2.3.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#pimp-my-graph"><i class="fa fa-check"></i><b>2.3.6</b> Pimp my graph!</a></li>
<li class="chapter" data-level="2.3.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#spatial-data-in-r"><i class="fa fa-check"></i><b>2.3.7</b> Spatial Data in R</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#making-maps-using-ggplot2"><i class="fa fa-check"></i><b>2.4</b> Making maps using ggplot2</a><ul>
<li class="chapter" data-level="2.4.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#changing-projections"><i class="fa fa-check"></i><b>2.4.1</b> Changing projections</a></li>
<li class="chapter" data-level="2.4.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#maps-with-extra-features"><i class="fa fa-check"></i><b>2.4.2</b> Maps with extra features</a></li>
<li class="chapter" data-level="2.4.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#extension"><i class="fa fa-check"></i><b>2.4.3</b> Extension</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="rasters-descriptive-statistics-and-interpolation.html"><a href="rasters-descriptive-statistics-and-interpolation.html"><i class="fa fa-check"></i><b>3</b> Rasters, descriptive statistics and interpolation</a><ul>
<li class="chapter" data-level="3.1" data-path="rasters-descriptive-statistics-and-interpolation.html"><a href="rasters-descriptive-statistics-and-interpolation.html#learning-outcomes-2"><i class="fa fa-check"></i><b>3.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="3.2" data-path="rasters-descriptive-statistics-and-interpolation.html"><a href="rasters-descriptive-statistics-and-interpolation.html#introduction-4"><i class="fa fa-check"></i><b>3.2</b> Introduction</a></li>
<li class="chapter" data-level="3.3" data-path="rasters-descriptive-statistics-and-interpolation.html"><a href="rasters-descriptive-statistics-and-interpolation.html#part-1-rasters"><i class="fa fa-check"></i><b>3.3</b> Part 1 rasters</a><ul>
<li class="chapter" data-level="3.3.1" data-path="rasters-descriptive-statistics-and-interpolation.html"><a href="rasters-descriptive-statistics-and-interpolation.html#worldclim-data"><i class="fa fa-check"></i><b>3.3.1</b> WorldClim data</a></li>
<li class="chapter" data-level="3.3.2" data-path="rasters-descriptive-statistics-and-interpolation.html"><a href="rasters-descriptive-statistics-and-interpolation.html#location-data-from-a-raster"><i class="fa fa-check"></i><b>3.3.2</b> Location data from a raster</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="rasters-descriptive-statistics-and-interpolation.html"><a href="rasters-descriptive-statistics-and-interpolation.html#part-2-descriptive-statistics"><i class="fa fa-check"></i><b>3.4</b> Part 2 descriptive statistics</a><ul>
<li class="chapter" data-level="3.4.1" data-path="rasters-descriptive-statistics-and-interpolation.html"><a href="rasters-descriptive-statistics-and-interpolation.html#data-preparation"><i class="fa fa-check"></i><b>3.4.1</b> Data preparation</a></li>
<li class="chapter" data-level="3.4.2" data-path="rasters-descriptive-statistics-and-interpolation.html"><a href="rasters-descriptive-statistics-and-interpolation.html#histogram"><i class="fa fa-check"></i><b>3.4.2</b> Histogram</a></li>
<li class="chapter" data-level="3.4.3" data-path="rasters-descriptive-statistics-and-interpolation.html"><a href="rasters-descriptive-statistics-and-interpolation.html#using-more-data"><i class="fa fa-check"></i><b>3.4.3</b> Using more data</a></li>
<li class="chapter" data-level="3.4.4" data-path="rasters-descriptive-statistics-and-interpolation.html"><a href="rasters-descriptive-statistics-and-interpolation.html#histogram-with-ggplot"><i class="fa fa-check"></i><b>3.4.4</b> Histogram with ggplot</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="rasters-descriptive-statistics-and-interpolation.html"><a href="rasters-descriptive-statistics-and-interpolation.html#part-3-interpolation"><i class="fa fa-check"></i><b>3.5</b> Part 3 interpolation</a></li>
<li class="chapter" data-level="3.6" data-path="rasters-descriptive-statistics-and-interpolation.html"><a href="rasters-descriptive-statistics-and-interpolation.html#auto-data-download"><i class="fa fa-check"></i><b>3.6</b> Auto data download</a></li>
<li class="chapter" data-level="3.7" data-path="rasters-descriptive-statistics-and-interpolation.html"><a href="rasters-descriptive-statistics-and-interpolation.html#advanced-analysis"><i class="fa fa-check"></i><b>3.7</b> Advanced analysis</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html"><i class="fa fa-check"></i><b>4</b> Git, GitHub and RMarkdown</a><ul>
<li class="chapter" data-level="4.1" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#learning-outcomes-3"><i class="fa fa-check"></i><b>4.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="4.2" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#introduction-5"><i class="fa fa-check"></i><b>4.2</b> Introduction</a></li>
<li class="chapter" data-level="4.3" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#set-up-your-github"><i class="fa fa-check"></i><b>4.3</b> Set up your GitHub</a></li>
<li class="chapter" data-level="4.4" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#using-rstudio-with-git"><i class="fa fa-check"></i><b>4.4</b> Using RStudio with Git</a></li>
<li class="chapter" data-level="4.5" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#using-git-outside-rstudio"><i class="fa fa-check"></i><b>4.5</b> Using Git outside RStudio</a></li>
<li class="chapter" data-level="4.6" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#push-to-github"><i class="fa fa-check"></i><b>4.6</b> Push to Github</a></li>
<li class="chapter" data-level="4.7" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#pull-from-github"><i class="fa fa-check"></i><b>4.7</b> Pull from GitHub</a></li>
<li class="chapter" data-level="4.8" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#troubleshooting"><i class="fa fa-check"></i><b>4.8</b> Troubleshooting</a><ul>
<li class="chapter" data-level="4.8.1" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#were-you-challenged-for-your-password"><i class="fa fa-check"></i><b>4.8.1</b> Were you challenged for your password?</a></li>
<li class="chapter" data-level="4.8.2" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#greyed-out-push-button"><i class="fa fa-check"></i><b>4.8.2</b> Greyed out push button</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#fork-a-repository"><i class="fa fa-check"></i><b>4.9</b> Fork a repository</a></li>
<li class="chapter" data-level="4.10" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#branches"><i class="fa fa-check"></i><b>4.10</b> Branches</a><ul>
<li class="chapter" data-level="4.10.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#health-warning"><i class="fa fa-check"></i><b>4.10.1</b> Health warning</a></li>
</ul></li>
<li class="chapter" data-level="4.11" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#rmarkdown"><i class="fa fa-check"></i><b>4.11</b> RMarkdown</a></li>
<li class="chapter" data-level="4.12" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#adding-references"><i class="fa fa-check"></i><b>4.12</b> Adding references</a><ul>
<li class="chapter" data-level="4.12.1" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#set-up-mendeley"><i class="fa fa-check"></i><b>4.12.1</b> Set up Mendeley</a></li>
<li class="chapter" data-level="4.12.2" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#add-refereces-into-r"><i class="fa fa-check"></i><b>4.12.2</b> Add refereces into R</a></li>
<li class="chapter" data-level="4.12.3" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#references-using-citr"><i class="fa fa-check"></i><b>4.12.3</b> References using <code>citr</code></a></li>
<li class="chapter" data-level="4.12.4" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#knitting-your-output"><i class="fa fa-check"></i><b>4.12.4</b> Knitting your output</a></li>
</ul></li>
<li class="chapter" data-level="4.13" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#further-reading"><i class="fa fa-check"></i><b>4.13</b> Further Reading</a></li>
<li class="chapter" data-level="4.14" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#extension-1"><i class="fa fa-check"></i><b>4.14</b> Extension</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="map-making.html"><a href="map-making.html"><i class="fa fa-check"></i><b>5</b> Map making</a><ul>
<li class="chapter" data-level="5.1" data-path="map-making.html"><a href="map-making.html#learning-outcomes-4"><i class="fa fa-check"></i><b>5.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="5.2" data-path="map-making.html"><a href="map-making.html#introduction-6"><i class="fa fa-check"></i><b>5.2</b> Introduction</a></li>
<li class="chapter" data-level="5.3" data-path="map-making.html"><a href="map-making.html#data-1"><i class="fa fa-check"></i><b>5.3</b> Data</a><ul>
<li class="chapter" data-level="5.3.1" data-path="map-making.html"><a href="map-making.html#osm-1"><i class="fa fa-check"></i><b>5.3.1</b> OSM</a></li>
<li class="chapter" data-level="5.3.2" data-path="map-making.html"><a href="map-making.html#london-boroughs"><i class="fa fa-check"></i><b>5.3.2</b> London boroughs</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="map-making.html"><a href="map-making.html#mapping-in-arcmap"><i class="fa fa-check"></i><b>5.4</b> Mapping in ArcMap</a><ul>
<li class="chapter" data-level="5.4.1" data-path="map-making.html"><a href="map-making.html#load-data-3"><i class="fa fa-check"></i><b>5.4.1</b> Load data</a></li>
<li class="chapter" data-level="5.4.2" data-path="map-making.html"><a href="map-making.html#manipulate-data"><i class="fa fa-check"></i><b>5.4.2</b> Manipulate data</a></li>
<li class="chapter" data-level="5.4.3" data-path="map-making.html"><a href="map-making.html#map-data"><i class="fa fa-check"></i><b>5.4.3</b> Map data</a></li>
<li class="chapter" data-level="5.4.4" data-path="map-making.html"><a href="map-making.html#export-map"><i class="fa fa-check"></i><b>5.4.4</b> Export map</a></li>
<li class="chapter" data-level="5.4.5" data-path="map-making.html"><a href="map-making.html#model-builder"><i class="fa fa-check"></i><b>5.4.5</b> Model builder</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="map-making.html"><a href="map-making.html#qgis-1"><i class="fa fa-check"></i><b>5.5</b> QGIS</a><ul>
<li class="chapter" data-level="5.5.1" data-path="map-making.html"><a href="map-making.html#mapping"><i class="fa fa-check"></i><b>5.5.1</b> Mapping</a></li>
<li class="chapter" data-level="5.5.2" data-path="map-making.html"><a href="map-making.html#graphical-modeler"><i class="fa fa-check"></i><b>5.5.2</b> Graphical modeler</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="map-making.html"><a href="map-making.html#r-1"><i class="fa fa-check"></i><b>5.6</b> R</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="an-introduction-to-analysing-spatial-patterns.html"><a href="an-introduction-to-analysing-spatial-patterns.html"><i class="fa fa-check"></i><b>6</b> An Introduction to Analysing Spatial Patterns</a><ul>
<li class="chapter" data-level="6.1" data-path="an-introduction-to-analysing-spatial-patterns.html"><a href="an-introduction-to-analysing-spatial-patterns.html#learning-outcomes-5"><i class="fa fa-check"></i><b>6.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="6.2" data-path="an-introduction-to-analysing-spatial-patterns.html"><a href="an-introduction-to-analysing-spatial-patterns.html#introduction-7"><i class="fa fa-check"></i><b>6.2</b> Introduction</a></li>
<li class="chapter" data-level="6.3" data-path="an-introduction-to-analysing-spatial-patterns.html"><a href="an-introduction-to-analysing-spatial-patterns.html#setting-up-your-data"><i class="fa fa-check"></i><b>6.3</b> Setting up Your data</a><ul>
<li class="chapter" data-level="6.3.1" data-path="an-introduction-to-analysing-spatial-patterns.html"><a href="an-introduction-to-analysing-spatial-patterns.html#data-cleaning"><i class="fa fa-check"></i><b>6.3.1</b> Data cleaning</a></li>
<li class="chapter" data-level="6.3.2" data-path="an-introduction-to-analysing-spatial-patterns.html"><a href="an-introduction-to-analysing-spatial-patterns.html#study-area"><i class="fa fa-check"></i><b>6.3.2</b> Study area</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="an-introduction-to-analysing-spatial-patterns.html"><a href="an-introduction-to-analysing-spatial-patterns.html#point-pattern-analysis"><i class="fa fa-check"></i><b>6.4</b> Point pattern analysis</a><ul>
<li class="chapter" data-level="6.4.1" data-path="an-introduction-to-analysing-spatial-patterns.html"><a href="an-introduction-to-analysing-spatial-patterns.html#summarising-your-point-data---a-little-aside-on-kernel-density-estimation"><i class="fa fa-check"></i><b>6.4.1</b> Summarising your point data - a little aside on Kernel Density Estimation</a></li>
<li class="chapter" data-level="6.4.2" data-path="an-introduction-to-analysing-spatial-patterns.html"><a href="an-introduction-to-analysing-spatial-patterns.html#quadrat-analysis"><i class="fa fa-check"></i><b>6.4.2</b> Quadrat Analysis</a></li>
<li class="chapter" data-level="6.4.3" data-path="an-introduction-to-analysing-spatial-patterns.html"><a href="an-introduction-to-analysing-spatial-patterns.html#try-experimenting"><i class="fa fa-check"></i><b>6.4.3</b> Try experimenting…</a></li>
<li class="chapter" data-level="6.4.4" data-path="an-introduction-to-analysing-spatial-patterns.html"><a href="an-introduction-to-analysing-spatial-patterns.html#ripleys-k"><i class="fa fa-check"></i><b>6.4.4</b> Ripley’s K</a></li>
<li class="chapter" data-level="6.4.5" data-path="an-introduction-to-analysing-spatial-patterns.html"><a href="an-introduction-to-analysing-spatial-patterns.html#alternatives-to-ripleys-k"><i class="fa fa-check"></i><b>6.4.5</b> Alternatives to Ripley’s K</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="an-introduction-to-analysing-spatial-patterns.html"><a href="an-introduction-to-analysing-spatial-patterns.html#density-based-spatial-clustering-of-applications-with-noise-dbscan"><i class="fa fa-check"></i><b>6.5</b> Density-based spatial clustering of applications with noise: DBSCAN</a></li>
<li class="chapter" data-level="6.6" data-path="an-introduction-to-analysing-spatial-patterns.html"><a href="an-introduction-to-analysing-spatial-patterns.html#point-pattern-analysis-summary"><i class="fa fa-check"></i><b>6.6</b> Point pattern analysis summary</a></li>
<li class="chapter" data-level="6.7" data-path="an-introduction-to-analysing-spatial-patterns.html"><a href="an-introduction-to-analysing-spatial-patterns.html#analysing-spatial-autocorrelation-with-morans-i-lisa-and-friends"><i class="fa fa-check"></i><b>6.7</b> Analysing Spatial Autocorrelation with Moran’s I, LISA and friends</a><ul>
<li class="chapter" data-level="6.7.1" data-path="an-introduction-to-analysing-spatial-patterns.html"><a href="an-introduction-to-analysing-spatial-patterns.html#data-download-1"><i class="fa fa-check"></i><b>6.7.1</b> Data download</a></li>
<li class="chapter" data-level="6.7.2" data-path="an-introduction-to-analysing-spatial-patterns.html"><a href="an-introduction-to-analysing-spatial-patterns.html#data-cleaning-1"><i class="fa fa-check"></i><b>6.7.2</b> Data cleaning</a></li>
<li class="chapter" data-level="6.7.3" data-path="an-introduction-to-analysing-spatial-patterns.html"><a href="an-introduction-to-analysing-spatial-patterns.html#data-manipulation"><i class="fa fa-check"></i><b>6.7.3</b> Data manipulation</a></li>
<li class="chapter" data-level="6.7.4" data-path="an-introduction-to-analysing-spatial-patterns.html"><a href="an-introduction-to-analysing-spatial-patterns.html#spatial-autocorrelation"><i class="fa fa-check"></i><b>6.7.4</b> Spatial autocorrelation</a></li>
<li class="chapter" data-level="6.7.5" data-path="an-introduction-to-analysing-spatial-patterns.html"><a href="an-introduction-to-analysing-spatial-patterns.html#mapping-outputs"><i class="fa fa-check"></i><b>6.7.5</b> Mapping outputs</a></li>
<li class="chapter" data-level="6.7.6" data-path="an-introduction-to-analysing-spatial-patterns.html"><a href="an-introduction-to-analysing-spatial-patterns.html#other-variables"><i class="fa fa-check"></i><b>6.7.6</b> Other variables</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="an-introduction-to-analysing-spatial-patterns.html"><a href="an-introduction-to-analysing-spatial-patterns.html#extension-2"><i class="fa fa-check"></i><b>6.8</b> Extension</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html"><i class="fa fa-check"></i><b>7</b> Advanced raster analysis</a><ul>
<li class="chapter" data-level="7.1" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#learning-objectives"><i class="fa fa-check"></i><b>7.1</b> Learning objectives</a></li>
<li class="chapter" data-level="7.2" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#introduction-8"><i class="fa fa-check"></i><b>7.2</b> Introduction</a><ul>
<li class="chapter" data-level="7.2.1" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#remote-sensing-background-required"><i class="fa fa-check"></i><b>7.2.1</b> Remote sensing background (required)</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#data-2"><i class="fa fa-check"></i><b>7.3</b> Data</a><ul>
<li class="chapter" data-level="7.3.1" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#shapefile"><i class="fa fa-check"></i><b>7.3.1</b> Shapefile</a></li>
<li class="chapter" data-level="7.3.2" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#raster-data-landsat"><i class="fa fa-check"></i><b>7.3.2</b> Raster data (Landsat)</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#processing-raster-data"><i class="fa fa-check"></i><b>7.4</b> Processing raster data</a><ul>
<li class="chapter" data-level="7.4.1" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#loading"><i class="fa fa-check"></i><b>7.4.1</b> Loading</a></li>
<li class="chapter" data-level="7.4.2" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#resampling"><i class="fa fa-check"></i><b>7.4.2</b> Resampling</a></li>
<li class="chapter" data-level="7.4.3" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#clipping"><i class="fa fa-check"></i><b>7.4.3</b> Clipping</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#data-exploration"><i class="fa fa-check"></i><b>7.5</b> Data exploration</a><ul>
<li class="chapter" data-level="7.5.1" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#more-loading-and-manipulating"><i class="fa fa-check"></i><b>7.5.1</b> More loading and manipulating</a></li>
<li class="chapter" data-level="7.5.2" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#plotting-data"><i class="fa fa-check"></i><b>7.5.2</b> Plotting data</a></li>
<li class="chapter" data-level="7.5.3" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#data-similarity"><i class="fa fa-check"></i><b>7.5.3</b> Data similarity</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#basic-raster-calculations"><i class="fa fa-check"></i><b>7.6</b> Basic raster calculations</a><ul>
<li class="chapter" data-level="7.6.1" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#ndvi"><i class="fa fa-check"></i><b>7.6.1</b> NDVI</a></li>
<li class="chapter" data-level="7.6.2" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#ndvi-function"><i class="fa fa-check"></i><b>7.6.2</b> NDVI function</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#advanced-raster-calculations"><i class="fa fa-check"></i><b>7.7</b> Advanced raster calculations</a><ul>
<li class="chapter" data-level="7.7.1" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#calucating-tempearture-from-landsat-data"><i class="fa fa-check"></i><b>7.7.1</b> Calucating tempearture from Landsat data</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#calucating-urban-area-from-landsat-data"><i class="fa fa-check"></i><b>7.8</b> Calucating urban area from Landsat data</a></li>
<li class="chapter" data-level="7.9" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#urban-area-and-temperature-relationship"><i class="fa fa-check"></i><b>7.9</b> Urban area and temperature relationship</a></li>
<li class="chapter" data-level="7.10" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#statistical-summary"><i class="fa fa-check"></i><b>7.10</b> Statistical summary</a></li>
<li class="chapter" data-level="7.11" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#considerations"><i class="fa fa-check"></i><b>7.11</b> Considerations</a></li>
<li class="chapter" data-level="7.12" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#extension-3"><i class="fa fa-check"></i><b>7.12</b> Extension</a></li>
<li class="chapter" data-level="7.13" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#references"><i class="fa fa-check"></i><b>7.13</b> References</a></li>
<li class="chapter" data-level="7.14" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#remote-sensing-background-optional"><i class="fa fa-check"></i><b>7.14</b> Remote sensing background (optional)</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">CASA0005 Geographic Information Systems and Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="map-making" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Map making</h1>
<div id="learning-outcomes-4" class="section level2">
<h2><span class="header-section-number">5.1</span> Learning outcomes</h2>
<p>By the end of this practical you should be able to:</p>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>
</div>
<div id="introduction-6" class="section level2">
<h2><span class="header-section-number">5.2</span> Introduction</h2>
<p>In this practical we’re going to focus on creating mapped outputs using QGIS, ArcMap and R. For fun we’re going to use spatial boundaries from xxx and OpenStreetMap (OSM) data.</p>
</div>
<div id="data-1" class="section level2">
<h2><span class="header-section-number">5.3</span> Data</h2>
<p>It’s possible to download OSM data straight from the website, although the interface can be a little unreliable (it works better for small areas). There are, however, a number of websites that allow OSM data to be downloaded more easily and are directly linked to from the ‘Export’ option in OSM. Geofabrik (one of these websites) allows you to download frequently updated shapefiles for various global subdivisions.</p>
<div id="osm-1" class="section level3">
<h3><span class="header-section-number">5.3.1</span> OSM</h3>
<ol style="list-style-type: decimal">
<li><p>Go to the Geofabrik download server website: <a href="http://download.geofabrik.de/" class="uri">http://download.geofabrik.de/</a></p></li>
<li><p>Navigate to: Europe &gt; GreatBritain &gt; England &gt; Greater London</p></li>
<li><p>Download greater-london-latest-free.shp.zip</p></li>
<li><p>Unzip the data and save it to your current folder</p></li>
</ol>
</div>
<div id="london-boroughs" class="section level3">
<h3><span class="header-section-number">5.3.2</span> London boroughs</h3>
<p>We’ll use our London boroughs layer again, either load it from week 1 or download it:</p>
<ol start="5" style="list-style-type: decimal">
<li><p>To get the data go to: <a href="https://data.london.gov.uk/" class="uri">https://data.london.gov.uk/</a></p></li>
<li><p>Search for Statistical GIS Boundary Files for London</p></li>
<li><p>Download the statistical-gis-boundaries-london.zip</p></li>
<li><p>Unzip the data and save it to your current folder</p></li>
</ol>
</div>
</div>
<div id="mapping-in-arcmap" class="section level2">
<h2><span class="header-section-number">5.4</span> Mapping in ArcMap</h2>
<div id="load-data-3" class="section level3">
<h3><span class="header-section-number">5.4.1</span> Load data</h3>
<ol start="9" style="list-style-type: decimal">
<li>Open a new ArcMap document</li>
</ol>
<p><img src="prac5_images/arcmap.png" width="1000pt" style="display: block; margin: auto;" /></p>
<ol start="10" style="list-style-type: decimal">
<li>Accept the defaults and click OK</li>
</ol>
<p>11 On the right hand side of the ArcMap document there should be two tabs: Catalog and Search. If they aren’t visible click Windows &gt; Catalog, next to the little x for Catalog there will be a pin symbol that will pin it to the right hand side of the screen. Do the same for Search. Search will let you find any tool in ArcMap without knowing exactly what Toolbox it is stored in.</p>
<p><img src="prac5_images/catpin.png" width="500pt" style="display: block; margin: auto;" /></p>
<p>As we did in practical 1, let’s make a GeoDatabase to store out outputs.</p>
<ol start="12" style="list-style-type: decimal">
<li><p>Under the Catalog tab, click on the connect to folder icon (small folder with plus sign), navigate to your current folder and select it</p></li>
<li><p>Now in the Catalog tab you should see you folder that you connect it listed</p></li>
<li><p>Make a new File GeoDatebase by right clicking on the folder connection…</p></li>
</ol>
<p><img src="prac5_images/geodb.png" width="500pt" style="display: block; margin: auto;" /></p>
<ol start="15" style="list-style-type: decimal">
<li><p>Name it what you like, but make sure it retains the <code>.gdb</code> extension</p></li>
<li><p>Right click on it and make it the default GeoDatabase for the current map</p></li>
</ol>
<p><img src="prac5_images/geodbdefault.png" width="500pt" style="display: block; margin: auto;" /></p>
<ol start="17" style="list-style-type: decimal">
<li><p>As we did in practical 1, store relative pathnames…File &gt; Map Document Properties &gt; Store relative pathnames to data sources</p></li>
<li><p>Load the London boroughs shapefile using the add data button…if you are using the data from practical 1 and it’s stored in a different place you might need to make a new folder connection</p></li>
</ol>
<p><img src="prac5_images/adddata.png" width="800pt" style="display: block; margin: auto;" /></p>
<ol start="19" style="list-style-type: decimal">
<li><p>Load the OSM shapefiles using the add data button (pick anyone you want)…if you are using the data from practical 1 and it’s stored in a different place you might need to make a new folder connection</p></li>
<li><p>When you load the data to ArcMap you will probably be greeted with a warning…</p></li>
</ol>
<p><img src="prac5_images/projwarning.png" width="600pt" style="display: block; margin: auto;" /></p>
<p>This means that the data layer we are loading (OSM) has a different CRS to the dataframe (our current map document). If you recall from practical 1, ArcMap sets the map document CRS to that of the first layer loaded. Our London boroughs layer is in British National Grid where as are OSM layers are in WGS 1984.</p>
<ol start="21" style="list-style-type: decimal">
<li>Close the warning</li>
</ol>
<p>The OSM data will load and ArcMap is pretty clever here as it will project ‘on the fly’ which means it can display the data stored in one projection as if it were in another, but the actual data is not altered. This is both good and bad. Good as it let’s us visualise our data quickly, but bad because if we have data with different projections you will run into problems during processing. My advice is to load the data and pick a projection to do all processing in.</p>
<ol start="22" style="list-style-type: decimal">
<li><p>Here load the gis_osm_pois_a_free_1 polygon.shp layer.</p></li>
<li><p>In the search tool find the tool <code>reproject</code></p></li>
</ol>
<p><img src="prac5_images/reproj.png" width="500pt" style="display: block; margin: auto;" /></p>
<ol start="24" style="list-style-type: decimal">
<li>Select the osm layer as the input, give your output a name (it should be within your GeoDatabase) and select the coordiate system. When you click on the coordiate system selection box you will see a drop down called layers, expand the drop down and you’ll see what cooridate reference systems are in use for each layer open within the map. If you expand British_National_Grid you’ll see the London boroughs layer…</li>
</ol>
<p><img src="prac5_images/reproj2.png" width="800pt" style="display: block; margin: auto;" /></p>
<ol start="25" style="list-style-type: decimal">
<li><p>Click on British_National_Grid and select OK, under the Geographic Transformation a method will be automatically selected, click OK.</p></li>
<li><p>The new layer will be added to the Map document so remove the old one. Right click on the old layer &gt; Remove</p></li>
</ol>
</div>
<div id="manipulate-data" class="section level3">
<h3><span class="header-section-number">5.4.2</span> Manipulate data</h3>
<ol start="27" style="list-style-type: decimal">
<li>You’ll notice that some of the polygons from our OSM data fall outside the London boroughs layer, let’s sort this out. We could go right ahead and clip (like a cookie cutter) our OSM based on the outline of the London boroughs but this might cut in half some of the OSM polygons…for example:</li>
</ol>
<p><img src="prac5_images/clipexample.png" width="500pt" style="display: block; margin: auto;" /></p>
<p>However, it’s good to think about what we are actually interested in…in this example we will explore the distribution of hotels within the London boroughs, so let’s reduce our OSM data by picking out all of the hotels.</p>
<ol start="28" style="list-style-type: decimal">
<li><p>Right click on your OSM layer &gt; Open Atrtibute Table</p></li>
<li><p>Within the attribute table click on Select by Attributes. This lets you filter based on specifc values stored within the table…</p></li>
<li><p>Double click on fclass and it will populate the bottom box</p></li>
<li><p>Click unqiue values to see all of the values stored within fclass</p></li>
<li><p>Click the = sign, then click ‘hotel’ from the unique values box…</p></li>
</ol>
<p><img src="prac5_images/select_attribute.png" width="800pt" style="display: block; margin: auto;" /></p>
<ol start="33" style="list-style-type: decimal">
<li>Click apply…</li>
</ol>
<p>In the attribute table you will see 715 records are selected (as the OSM download updates your value might be slighly different to mine). You toggle between all records and selected records.</p>
<p><img src="prac5_images/att_select.png" width="700pt" style="display: block; margin: auto;" /></p>
<p>No we need to export our select data…</p>
<ol start="34" style="list-style-type: decimal">
<li>Close the attrbiute tabe &gt; right click on your OSM layer &gt; Data &gt; Export Data. Make sure you are exporting only the selected features into your GeoDatabase (output feature class). Click on the folder icon to give your layer an appropriate name then save and OK</li>
</ol>
<p><img src="prac5_images/hotels_export.png" width="800pt" style="display: block; margin: auto;" /></p>
<ol start="35" style="list-style-type: decimal">
<li>Add the layer the map and either turn off or remove the OSM layer we dervied only hotels from..</li>
</ol>
<p>Some of the hotels are still outside of the London boroughs, so let’s get rid of these through select by location</p>
<ol start="36" style="list-style-type: decimal">
<li><p>Go: Selection (top tool bar) &gt; Select By Location</p></li>
<li><p>Select featues from your OSM hotel only layer, with the source layer as London boroughs. Use the spatial selection method of: are completely within the source layer. So here we are saying only select the hotels that are within the London borough vector layer. Click apply &gt; OK</p></li>
<li><p>Now repeat the export process and remove or turn off the original layer.</p></li>
</ol>
<p>As part of this analysis it woild also be useful to know how much area the hotels occupy. So lets calcualte this.</p>
<ol start="39" style="list-style-type: decimal">
<li>Open the attribute table of your OSM hotels within London boroughs vector file. You will see a shape area field, but as we are using a local CRS now the values might be slightly different so let’s recompute it. Under Table Options select Add Field, call the new field Area2 and select the type as Float.</li>
</ol>
<p><img src="prac5_images/addfield.png" width="700pt" style="display: block; margin: auto;" /></p>
<ol start="40" style="list-style-type: decimal">
<li>Right click the new field &gt; Calcualte Geometry select OK and yes to any warnings.</li>
</ol>
<p>Now let’s calcualte how many hotels are within each London borough and their total area…</p>
<ol start="41" style="list-style-type: decimal">
<li><p>Before we can use the Spatial Join tool we need to enable some extensions in ArcMap. Click Ccustomize &gt; Extensions… and select Spatial Analyst. Save your document then close and reload it.</p></li>
<li><p>Using the search tool bar find the tool Spatial Join. Select the target features as the London borough vector layer and the Join Features as the OSM hotels within the London boroughs. Specify an output name (within your GeoDatabase) and leave the Join Operation as one to one.</p></li>
<li><p>Now, in the Field Map of Join Features delete everthing except: NAME, GSS_CODE, osm_id and Area2</p></li>
<li><p>Right click on the osm_id and select count — this will count the number of hotel shape ids within each borough, we could have used hotel name, but i noticed that some were missing. Every feature should have an ID number, so we can capture all hotels.</p></li>
</ol>
<p><img src="prac5_images/count.png" width="800pt" style="display: block; margin: auto;" /></p>
<ol start="45" style="list-style-type: decimal">
<li><p>Now do the same for Area2 but select Sum — to total the area of hotels within each borough</p></li>
<li><p>Select the match option as contains, click show help for more information, click OK</p></li>
</ol>
<p>The output has counted the number of osm_ids within each borough and summed their areas…let’s now work out the percent of each London borough covered by hotels</p>
<ol start="47" style="list-style-type: decimal">
<li><p>Add a new field as we did before called percent ensuring you select Float as the type</p></li>
<li><p>Right click the new field &gt; Field Calculator and accept the warning message</p></li>
<li><p>Percent will equal our (Area2/Shape_Area)*100…ArcMap computed a new area field for us</p></li>
</ol>
<p><img src="prac5_images/field_calc.png" width="800pt" style="display: block; margin: auto;" /></p>
<p>As expected the values are pretty small, but not to worry we can scale our map accordingly, but it’s also imporant to consider what is the best method to display data (e.g. counts, percentages)</p>
<p>Ok, let’s make some maps</p>
</div>
<div id="map-data" class="section level3">
<h3><span class="header-section-number">5.4.3</span> Map data</h3>
<ol start="50" style="list-style-type: decimal">
<li>There are two ‘views’ in ArcMap data view (which is what we are on) and Layout view, to switch to layout view click View (top tool bar) &gt; Layout view</li>
</ol>
<p>Layout view is where we make maps to export. You should see any layers you have open (ticked) within the Layout view.</p>
<ol start="51" style="list-style-type: decimal">
<li>Layers are stored in a dataframe, to see this in action click Insert &gt; Data Frame</li>
</ol>
<p>You should see a new dataframe appear, if you click it you can drag in around the layout view</p>
<ol start="52" style="list-style-type: decimal">
<li>Switch back to data view…everthing has gone? That’s because you have the new data frame activated which has no data. Right click on your original data frame (mine is called layers) and select activate</li>
</ol>
<p><img src="prac5_images/activate.png" width="700pt" style="display: block; margin: auto;" /></p>
<p>Head back to layout view and let’s make a thematic map of our data</p>
<ol start="53" style="list-style-type: decimal">
<li>Right click on your current layer (hotels within London boroughs) select the Symbology tab then Quantities (in the left hand coloumn) use Join_Count (where we summed the hotels per borough) as the value and pick a colour ramp. Also experiment with the classify button under classificaiton. Once you are happy click OK.</li>
</ol>
<p>You should have something like this:</p>
<p><img src="prac5_images/map1.png" width="700pt" style="display: block; margin: auto;" /></p>
<p>How about we spice things up a bit with some more data…</p>
<p>Let’s have a look at Air b n b data and make a map with the same scale to compare to hotels…</p>
<ol start="54" style="list-style-type: decimal">
<li><p>Go to: <a href="http://insideairbnb.com/get-the-data.html" class="uri">http://insideairbnb.com/get-the-data.html</a> and dowlonad the listings.csv data for London. Have a lookg at the data in excel if you wish…listings.csv.gz also has much more data.</p></li>
<li><p>Unzip the data and add it to your current working folder</p></li>
<li><p>In ArcMap switch back to the data view and add in your original London boroughs <code>.shp</code> from practical 1.</p></li>
<li><p>Now go File &gt; Add Data &gt; Add XY Data</p></li>
</ol>
<p><img src="prac5_images/addXY.png" width="700pt" style="display: block; margin: auto;" /></p>
<ol start="58" style="list-style-type: decimal">
<li><p>Navigate your listings.csv, select longitude as the X Field and latitude as the Y Field. You now need to change the Coordiate System of the Input…click edit, scroll up and select Geographic Coordiante Systems &gt; World &gt; WGS 1984 then click OK and click OK abou the ID warning.</p></li>
<li><p>When you load data through add XY you need to export it to a new layer as at the moment we are still reading off the <code>.csv</code>. Right click on it &gt; Export Data, select an appropraite name, add it too the Map, then remove the <code>.csv</code> from ArcMap.</p></li>
<li><p>As before you need to select only those points within the London boroughs then compute the number of air b n bs per borough….have a go at this yourself, if you get stuck go back and revisit the previous instructions…To try and make the comparsion a bit more even (scientific!) we shall filter the air b n b data (using select by attrbiutes) for only rentals that are classed as Entire home/apt and are available 365 days of the year…the select by attriubte code would be: room_type = ‘Entire home/apt’ AND availability_365 = 365</p></li>
</ol>
<p>Under layout view you should now have two maps</p>
<ol start="61" style="list-style-type: decimal">
<li>Let’s now set the symbology range of each map to match. Here i’m going to take the hotel symbology range and apply it to the air b n b data. Open the Symbology of Air b n b layer and click Import then select the Import symbology from another layer…pick the hotel layer &gt; OK &gt; OK</li>
</ol>
<p>Now rearrange the data franes in the layout view. Hint: you can click and drag, resize using the corners or right click (on the data frame itself) &gt; Properties &gt; Size and Position. If you check out the Frame tab you can alter that too. You can also add ruler guides by clicking in the measurement window at the top and left of the page…</p>
<p>To add a legend/title/North Arrow/sacle bar go Insert then select one…</p>
<p>If you select the defaults for the legend you can then right click it and alter all the Properties. I don’t show the Title and Items (tab) &gt; Style select only Layer Name and Label</p>
<p><img src="prac5_images/Legend_info.png" width="700pt" style="display: block; margin: auto;" /></p>
<p>You can change the layer names by single left clicking them in the Table of Contents…</p>
<p><img src="prac5_images/change_name.png" width="400pt" style="display: block; margin: auto;" /></p>
<p>Similarly if you select the defaults for a scale bar then right click &gt; Properties and change the division units to KM and reduce the number of dvisions and subdivisions to 2</p>
<p>Finally we can add an inset map…</p>
<ol start="62" style="list-style-type: decimal">
<li><p>Grab a UK outline (or any other that you think is appropraite). Go to GADM and download the <code>.shp</code>: <a href="https://gadm.org/download_country_v3.html" class="uri">https://gadm.org/download_country_v3.html</a>. Extract, unzip and put it in your current working folder.</p></li>
<li><p>Make a new data frame in your ArcMap document in data view and add in the <code>.shp</code> of the UK outline — there are a few in the zipped folder so work out which one you need. You’ll need to reproject it to British National Grid like we did with our other layers and save it in your GeoDatabase</p></li>
<li><p>As you made a new data frame and the first layer you added had the CRS of WGS84 the new data frame defaulted to this, let’s change is to British National Grid for consistency. Right click anyway on the map (white space around the polygon of the UK) &gt; Data Frame Properties &gt; scroll down to layers &gt; select British National Grid. The shape of the UK should change a bit…</p></li>
</ol>
<p><img src="prac5_images/dataframeprop.png" width="400pt" style="display: block; margin: auto;" /></p>
<p>Cool, switch back to layer view you should see your three data frames, position them how you would like on the page…the black outline you can see is an A4 page</p>
<p><em>Hints</em> If you right click on a layer you can zoom to it or use the + and - icons to position the layers how you like within each frame…</p>
<p><img src="prac5_images/zoom.png" width="400pt" style="display: block; margin: auto;" /></p>
<ol start="65" style="list-style-type: decimal">
<li><p>You can also add city points and names if you want to. I get these proem the ArcGIS Hub: <a href="https://hub.arcgis.com/datasets/6996f03a1b364dbab4008d99380370ed_0" class="uri">https://hub.arcgis.com/datasets/6996f03a1b364dbab4008d99380370ed_0</a>. Dowlonad, unzip and put the shapefile in your current working folder.</p></li>
<li><p>They are in the wrong CRS, so reproject and then extract only the points within the UK (select by location we used earlier). You should have a point file with 15 records… you could also filter them (select by attribute) on other coloumns (e.g. if you only wanted to show cities with a population greater than or equal to 250,000).</p></li>
<li><p>Let’s show the names of the cities to give our inset map some context. Right click on the cities point layer &gt; Properties &gt; Labels (tab) &gt; check Label features in this layer and select the Label Field as CITY_NAME. Change the font if you wish, click OK</p></li>
<li><p>Let’s add some text to acknowledge where we got our data from…so websites will have a statement you can copy others you can just write a statement yourself. This dones’t always have to be on the Map but should appear on the same page. Click Insert &gt; Text. The box will be very small, so move it and rezie. Double click to add some text….</p></li>
<li><p>TO export the map go: File &gt; Export Map…but wait… there is an otpion to export only the ‘active’ part of the map (or the graphics extent), but to do so you’ll need to add a box or neatline around only what you want exported. Click Insert &gt; Neatline. Once you have it in position remove the frame. Right click on the Neatline &gt; Properties &gt; Frame (tab) change to none.</p></li>
</ol>
</div>
<div id="export-map" class="section level3">
<h3><span class="header-section-number">5.4.4</span> Export map</h3>
<ol start="70" style="list-style-type: decimal">
<li>Go File &gt; Export Map, save it as a <code>.TIFF</code> and check the Clip Output to Graphics Extent button (at the very bottom of the box).</li>
</ol>
<p>Here is what my Layout view looked like</p>
<p><img src="prac5_images/layout.png" width="800" style="display: block; margin: auto;" /></p>
<p>And here is what my map looked like…</p>
<p><img src="prac5_data/examplemap.png" width="800" style="display: block; margin: auto;" /></p>
<p>Note there are some issues with mine…look at the inset map and how in Scotland there are more points than place names — this is beacuse my font is too large and they overlap.</p>
</div>
<div id="model-builder" class="section level3">
<h3><span class="header-section-number">5.4.5</span> Model builder</h3>
<p>In ArcMap you can automate tasks to an extent using model builder…i’ll give a brief example with some of the data we have used</p>
<ol start="71" style="list-style-type: decimal">
<li>Click on the ModelBuilder icon</li>
</ol>
<p><img src="prac5_images/modelbuilder.png" width="800" style="display: block; margin: auto;" /></p>
<p>Model builder let’s you line all the tools we have used up and then to run them automatically….here I have got my original World_Cities <code>.shp</code> that needs projecting and then the points within the UK extracting…</p>
<p><img src="prac5_images/model2.png" width="800" style="display: block; margin: auto;" /></p>
<p>To join up the layers to the tools you can either double click on the tool and complete the fields or use the connect icon. Here i had to double click the tool to specify the new CRS. Once the model has all the required fields in changes colour, you can then validate it and run it using the tick and play button respectively.</p>
<p><img src="prac5_images/model3.png" width="800" style="display: block; margin: auto;" /></p>
<p>You can also save the model (Model &gt; Save As) to use later (basically you can make a tool like you have been using — such as reproject), but it must be saved within a toolbox.</p>
<p><img src="prac5_images/toolbox.png" width="800" style="display: block; margin: auto;" /></p>
<p>In the next stage i’d select all my points within the UK, however select by location isn’t available in Model Builder, instead we could use Intersect or Clip. If you wanted to use selected by attribute you could use the tool Feature Class to Feature Class and specify your SQL code.</p>
</div>
</div>
<div id="qgis-1" class="section level2">
<h2><span class="header-section-number">5.5</span> QGIS</h2>
<p>Ok, now we’re going to reproduce our map in QIGS. As i’ve given most of the reasoning behind all the tools in the previous ArcMap section this will be more quickfire…</p>
<ol start="72" style="list-style-type: decimal">
<li><p>Load QGIS, Open and Save a new project (Project &gt; New)</p></li>
<li><p>Right click on GeoPackage and create a new database to store our data in <code>.gpkg</code></p></li>
<li><p>Load our data layers: London boroughs and OSM data (OSM data should be the gis_osm_pois_a_free_1 polygon layer)</p></li>
<li><p>Reproject the OSM data. If you scroll right in the dialogue box you’ll be able to save it into your GeoPackage. You might need to refresh the browers to see the layer in the</p></li>
</ol>
<p><img src="prac5_images/QGIS_reproj.png" width="800" style="display: block; margin: auto;" /></p>
<ol start="76" style="list-style-type: decimal">
<li><p>While we are working with projections…check the CRS of your map (bottom right)…mine is EPSG 4326 and we want it to be in British National Grid (which is ESPG: 27700), click on it and apply.</p></li>
<li><p>For completness also drag and drop your London boroughs <code>.shp</code> from the Layers window (bottom left) into your GeoPacakge. Remove the old one from the Layers window. Double click on the new London boroughs layer in the GeoPackage and it will open</p></li>
<li><p>To get only the hotels out of our OSM data we can use extract by attrbitue…this is my tool dialogue box</p></li>
</ol>
<p><img src="prac5_images/extractattribute.png" width="800" style="display: block; margin: auto;" /></p>
<ol start="79" style="list-style-type: decimal">
<li><p>Refresh the browser —you have to do this everytime. Double click the layer to load it.</p></li>
<li><p>Now extract by location using the file you just created and the London boroughs (so hotels within the London boroughs). Note that i selected that the hotels are within the Lonon boroughs</p></li>
</ol>
<p><img src="prac5_images/extractbylocation.png" width="800" style="display: block; margin: auto;" /></p>
<ol start="81" style="list-style-type: decimal">
<li><p>Let’s now count our hotels per London borough using Join Attributes by Location (Summary). Note i selected the osm_id field to summarise using count in summaries to calcualte</p></li>
<li><p>Next up is the Air b n b data, i’ll show you how to load it then you need to produce a count of rentals per London borough using the same rules as before (entire place/apartment and available all year). To load the data click Data Source Manager &gt; Delimited Text:</p></li>
</ol>
<p><img src="prac5_images/QGISsymbology.png" width="800" style="display: block; margin: auto;" /></p>
<p>You need to:
* Sort the projection out and save into your <code>.gpkg</code>
* Select by attibute (entire place and 365 days)
* Select by location (within London boroughs)
* Join the output to a new (or original) London borough polygon layer</p>
<p><strong>Note</strong> You can filter by multiple attributes using extract by expression…here we would use the expression (“room_type” ILIKE ‘%Entire home/apt%’) AND (“availability_365” ILIKE ‘%365%’) to filter based on entire home/apt and available 365 days of the year.</p>
<ol start="83" style="list-style-type: decimal">
<li>So now you should have two London borough layers one with a count of all the hotels and the other with a count of all the air b n b properties…To make a thematic map right click on the hotel layer &gt; Symbology (tab) select Graduated and your count coloumn as the coloumn, mode as natural breaks and then classify…</li>
</ol>
<p><img src="prac5_images/QGISxy.png" width="800" style="display: block; margin: auto;" /></p>
<ol start="84" style="list-style-type: decimal">
<li><p>Now save the style so we can use it on our other layer….Style &gt; Save Style &gt; select in Database and provide a name</p></li>
<li><p>Go to the symbology of the other layer &gt; select Graduated, select the correct count coloumn, then Style &gt; Load Style, from database and your saved style should be listed.</p></li>
</ol>
<div id="mapping" class="section level3">
<h3><span class="header-section-number">5.5.1</span> Mapping</h3>
<ol start="86" style="list-style-type: decimal">
<li><p>To create a new map document in QGIS go: Project &gt; New Print Layout. THe layout works by adding a new map which is a snapshop of the main QGIS document….</p></li>
<li><p>In the main QGIS document only select your airbnb layer, right click and zoom to it. GO back to the Print Layout &gt; Add Item &gt; Add Map..draw a sqaure…the layer should appear…In the window at the bottom right under Item Properties select to Lock layers…so now if you were to unselect that layer it would still remain on in the Print Layout</p></li>
<li><p>Go back to your main QGIS document, now only select the hotels layer…repeat the Add Map steps and lock the layers</p></li>
<li><p>Make sure give the same size to both Maps…to do so click on a Map &gt; Item Properties (bottom right) scroll down, expand Position and Size, give the same width and height values</p></li>
</ol>
<p><img src="prac5_images/positionsize.png" width="800" style="display: block; margin: auto;" /></p>
<ol start="90" style="list-style-type: decimal">
<li><p>Add some guides to line everything up go: View &gt; Manage Guides. The guides panel will appear in the bottom right hand corner, click the + to add a guide at a distance you specify. You can then drag your maps to snap to the guides.</p></li>
<li><p>Add a scale bar: Add Item &gt; Add Scale Bar. TO adjust it, right click &gt; Item Properties…alter some of the properties to make it look appropraite.</p></li>
<li><p>Add a legend: Add Item &gt; Add Legend and draw a sqaure. Same process to adjust it. Untick Auto update then you can use the + and - icons to remove items along with the edit icon to change the text…this is what mine looks like…</p></li>
</ol>
<p><img src="prac5_images/QGIS_legend.png" width="800" style="display: block; margin: auto;" /></p>
<ol start="93" style="list-style-type: decimal">
<li><p>Add an arrow: Add Item &gt; Add Arrow, left click to start (twice) and right click to finish.</p></li>
<li><p>Add text: In the left hand tool bar click add text box and draw a square</p></li>
<li><p>Let’s add our extent map, load the UK <code>.shp</code>, reproject it and save it into your <code>.gpkg</code>. Do the same for your city points but be sure to load them into your <code>.gpkg</code> before you run any tool (just drag and drop them). When reprojecting you might see a lot of errors for certain points in the processing box…don’t worry British National Grid only covers the UK — these errors will be for points outside of the UK which we will remove</p></li>
<li><p>Now replicate our ArcMap inset map by opening the Layer Properties of the new cities layer &gt; Labels &gt; Single Labels with city name, alter any of the text styles as you wish. Also play around with the symbology..</p></li>
<li><p>Add the new map into your map layout and move the items to appropraite locations…</p></li>
</ol>
<p>This is what i came up with in my map layout</p>
<p><img src="prac5_images/QGIS_maplayout.png" width="800" style="display: block; margin: auto;" /></p>
<p>To export your map to a file go: Layout &gt; Export as Image and select crop to content…and here is my map…</p>
<p><img src="prac5_data/QGIS_hotel.png" width="920" style="display: block; margin: auto;" /></p>
<p><strong>Note</strong> there are a few problems with my map that could be improved:
(a) If you look closely at the vector layer for London you will see that one of the boroughs is missing from map (b) — this is most likely because it has no data but could easily be fixed
(b) Whilst this time i’ve displayed all the city names the colour scheme needs work…for ideas on this check out colour</p>
</div>
<div id="graphical-modeler" class="section level3">
<h3><span class="header-section-number">5.5.2</span> Graphical modeler</h3>
<p>As in ArcMap we can automate the methodological process in QGIS using the graphical modeler..again i’ll provide a short example here</p>
<ol start="98" style="list-style-type: decimal">
<li>Go: Processing &gt; Graphical Modeler</li>
</ol>
<p>Graphical modeler is a bit different to model builder in ArcMap, here you drag inputs and algorthims from the inputs box (bottom left) into the model, you don’t need to specify the inputs here. When you click the run buttom (play on the top toolbar) you’ll be asked to provide the layers for the inputs. The options will be limited to those you currently have open in your map…check out the model i made to automate reprojecting cities and the UK outline, then extracting the cities within the UK outline…</p>
<p><img src="prac5_data/QGIS_model.png" style="display: block; margin: auto;" /></p>
<p>Make sure you save your model from the top tool bar either as a standalone model or within your project</p>
</div>
</div>
<div id="r-1" class="section level2">
<h2><span class="header-section-number">5.6</span> R</h2>
<p>Your R and geogprahical are certainly improving by now, so i’m just going to provide you with the R code i used to do this analysis..we’ll then have a quick look at making a Shiny app using the data — which i’ll explain fully.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">##Load all our data</span>
<span class="kw">library</span>(sf)
<span class="kw">library</span>(tmap)

OSM &lt;-<span class="st"> </span><span class="kw">read_shape</span>(<span class="st">&quot;prac5_data/greater-london-latest-free.shp/gis_osm_pois_a_free_1.shp&quot;</span>,
                  <span class="dt">as.sf =</span> <span class="ot">TRUE</span>)

Londonborough &lt;-<span class="st"> </span><span class="kw">read_shape</span>(<span class="st">&quot;Prac1_data/statistical-gis-boundaries-london/ESRI/London_Borough_Excluding_MHW.shp&quot;</span>,
                            <span class="dt">as.sf =</span> <span class="ot">TRUE</span>)

Airbnb &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;prac5_data/listings.csv&quot;</span>)
  
Worldcities &lt;-<span class="st"> </span><span class="kw">read_shape</span>(<span class="st">&quot;prac5_data/World_Cities/World_Cities.shp&quot;</span>, 
                          <span class="dt">as.sf =</span> <span class="ot">TRUE</span>)

<span class="co"># load as sp to use with spatialpointsdataframe  </span>
UK_outline &lt;-<span class="st"> </span><span class="kw">read_shape</span>(<span class="st">&quot;prac5_data/gadm36_GBR_shp/gadm36_GBR_0.shp&quot;</span>, 
                         <span class="dt">as.sf =</span> <span class="ot">TRUE</span>)

<span class="co"># plot xy data</span>
Airbnb &lt;-<span class="st"> </span><span class="kw">st_as_sf</span>(Airbnb, <span class="dt">coords =</span> <span class="kw">c</span>(<span class="st">&quot;longitude&quot;</span>, <span class="st">&quot;latitude&quot;</span>), 
                   <span class="dt">crs =</span> <span class="dv">4326</span>)

<span class="co"># reproject</span>
OSM &lt;-<span class="st"> </span><span class="kw">st_transform</span>(OSM, <span class="dv">27700</span>)
Worldcities &lt;-<span class="st"> </span><span class="kw">st_transform</span>(Worldcities, <span class="dv">27700</span>)
UK_outline &lt;-<span class="st"> </span><span class="kw">st_transform</span>(UK_outline, <span class="dv">27700</span>)
Airbnb &lt;-<span class="st"> </span><span class="kw">st_transform</span>(Airbnb, <span class="dv">27700</span>)
<span class="co"># we don&#39;t need to reproject Londonborough, but it </span>
<span class="co"># doesn&#39;t have a CRS..you could also use set_crs</span>
<span class="co"># it needs to have one for the next step</span>
Londonborough &lt;-<span class="st"> </span><span class="kw">st_transform</span>(Londonborough, <span class="dv">27700</span>)

<span class="co">#select hotels only</span>
OSM &lt;-<span class="st"> </span>OSM[OSM<span class="op">$</span>fclass <span class="op">==</span><span class="st"> &#39;hotel&#39;</span>,]
Airbnb &lt;-<span class="st"> </span>Airbnb[Airbnb<span class="op">$</span>room_type <span class="op">==</span><span class="st"> &#39;Entire home/apt&#39;</span> <span class="op">&amp;</span>
<span class="st">                   </span>Airbnb<span class="op">$</span>availability_<span class="dv">365</span><span class="op">==</span><span class="st">&#39;365&#39;</span>,]

<span class="co"># make a function for the join</span>
<span class="co"># functions are covered in practical 7</span>
<span class="co"># but see if you can work out what is going on</span>
<span class="co"># hint all you have to do is replace data1 and data2</span>
<span class="co"># with the data you want to use</span>

Joinfun &lt;-<span class="st"> </span><span class="cf">function</span>(data1, data2) {
  <span class="co"># join OSM and London boroughs</span>
  joined &lt;-<span class="st"> </span><span class="kw">st_join</span>(data1, data2, <span class="dt">join =</span> st_within)
  
  <span class="co"># count the number of hotels per borough</span>
  tree_tract_count &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">count</span>(joined<span class="op">$</span>GSS_CODE))
  
  <span class="co"># join the count back to the borough layer</span>
  o &lt;-<span class="kw">left_join</span>(data2, tree_tract_count, <span class="dt">by=</span><span class="kw">c</span>(<span class="st">&quot;GSS_CODE&quot;</span>=<span class="st">&quot;x&quot;</span>))
  
  <span class="kw">return</span>(o)
}

<span class="co"># use the function for hotels</span>
Hotels &lt;-<span class="st"> </span><span class="kw">Joinfun</span>(OSM, Londonborough)

<span class="co"># then for airbnb</span>
Airbnb &lt;-<span class="st"> </span><span class="kw">Joinfun</span>(Airbnb, Londonborough)

Worldcities2 &lt;-<span class="st"> </span>Worldcities[Worldcities<span class="op">$</span>CNTRY_NAME<span class="op">==</span><span class="st">&#39;United Kingdom&#39;</span><span class="op">&amp;</span>
<span class="st">                              </span>Worldcities<span class="op">$</span>CITY_NAME<span class="op">==</span><span class="st">&#39;Birmingham&#39;</span><span class="op">|</span>
<span class="st">                              </span>Worldcities<span class="op">$</span>CITY_NAME<span class="op">==</span><span class="st">&#39;London&#39;</span><span class="op">|</span>
<span class="st">                              </span>Worldcities<span class="op">$</span>CITY_NAME<span class="op">==</span><span class="st">&#39;Edinburgh&#39;</span>,]

newbb &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">xmin=</span><span class="op">-</span><span class="dv">296000</span>, <span class="dt">ymin=</span><span class="dv">5408</span>, <span class="dt">xmax=</span><span class="dv">655696</span>, <span class="dt">ymax=</span><span class="dv">1000000</span>)
UK_outlinecrop=<span class="kw">st_crop</span>(UK_outline<span class="op">$</span>geometry, newbb)

<span class="co"># now try to arrange the plots with tmap</span>
breaks =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">12</span>, <span class="dv">26</span>, <span class="dv">57</span>, <span class="dv">286</span>) 

<span class="co">#change the column name from freq for the legend</span>
<span class="kw">colnames</span>(Hotels)[<span class="kw">colnames</span>(Hotels)<span class="op">==</span><span class="st">&quot;freq&quot;</span>] &lt;-<span class="st"> &quot;Accom count&quot;</span>

tm1 &lt;-<span class="st"> </span><span class="kw">tm_shape</span>(Hotels) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tm_polygons</span>(<span class="st">&quot;Accom count&quot;</span>, <span class="dt">breaks=</span>breaks)<span class="op">+</span>
<span class="st">  </span><span class="kw">tm_legend</span>(<span class="dt">show=</span><span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">tm_layout</span>(<span class="dt">frame=</span><span class="ot">FALSE</span>)


tm2 &lt;-<span class="st"> </span><span class="kw">tm_shape</span>(Airbnb) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tm_polygons</span>(<span class="st">&quot;freq&quot;</span>, <span class="dt">breaks=</span>breaks) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tm_legend</span>(<span class="dt">show=</span><span class="ot">FALSE</span>)
  <span class="kw">tm_layout</span>(<span class="dt">frame=</span><span class="ot">FALSE</span>)</code></pre>
<pre><code>## $tm_layout
## $tm_layout$frame
## [1] FALSE
## 
## $tm_layout$style
## [1] NA
## 
## 
## attr(,&quot;class&quot;)
## [1] &quot;tm&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">tm3 &lt;-<span class="st"> </span><span class="kw">tm_shape</span>(UK_outlinecrop)<span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tm_polygons</span>(<span class="dt">col=</span><span class="st">&quot;darkslategray1&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">tm_layout</span>(<span class="dt">frame=</span><span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">tm_shape</span>(Worldcities2) <span class="op">+</span>
<span class="st">  </span><span class="kw">tm_symbols</span>(<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">scale =</span> <span class="fl">.5</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">tm_text</span>(<span class="st">&quot;CITY_NAME&quot;</span>, <span class="dt">xmod=</span><span class="op">-</span><span class="dv">1</span>, <span class="dt">ymod=</span><span class="op">-</span><span class="fl">0.5</span>)

legend &lt;-<span class="st"> </span><span class="kw">tm_shape</span>(Hotels) <span class="op">+</span>
<span class="st">    </span><span class="kw">tm_polygons</span>(<span class="st">&quot;Accom count&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">tm_scale_bar</span>(<span class="dt">position=</span><span class="kw">c</span>(<span class="fl">0.2</span>,<span class="fl">0.01</span>), <span class="dt">size=</span><span class="fl">0.6</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">tm_compass</span>(<span class="dt">north=</span><span class="dv">0</span>, <span class="dt">position=</span><span class="kw">c</span>(<span class="fl">0.65</span>,<span class="fl">0.6</span>))<span class="op">+</span>
<span class="st">    </span><span class="kw">tm_layout</span>(<span class="dt">legend.only =</span> <span class="ot">TRUE</span>, <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="fl">0.2</span>,<span class="fl">0.25</span>),<span class="dt">asp=</span><span class="fl">0.1</span>)

t=<span class="kw">tmap_arrange</span>(tm1, tm2, tm3, legend, <span class="dt">ncol=</span><span class="dv">2</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">t</code></pre>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-238-1.png" width="800pt" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="git-github-and-rmarkdown.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="an-introduction-to-analysing-spatial-patterns.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/05-prac5.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["CASA0005.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
